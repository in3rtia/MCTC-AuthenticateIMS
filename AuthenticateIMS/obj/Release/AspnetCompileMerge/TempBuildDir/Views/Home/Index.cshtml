@{
    ViewBag.Title = "Home Page";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<style type="text/css">
    html {
        overflow: hidden;
    }
</style>

<!-- Content Header (Page header) -->
<section class="content-header">
    <h1>
        Dashboard
        <small>View</small>
    </h1>
    <ol class="breadcrumb">
        <li><a href="@Url.Action("Index", "Home")"><i class="fa fa-dashboard"></i> Home</a></li>
        <li class="active">Dashboard</li>
    </ol>
</section>

<!-- Main content -->
<section class="content">
    <div class="row">
        <div class="col-md-3 col-sm-4 col-xs-12">
            <a href="@Url.Action("RecentRequests", "RequestDetails")")">
                <div class="info-box">
                    <span class="info-box-icon bg-aqua"><i class="fa fa-bell"></i></span>
                    <div class="info-box-content">
                        <h4>Recent Requests</h4>
                        @*<span class="info-box-number">90<small>%</small></span>*@
                    </div>
                    <!-- /.info-box-content -->
                </div>
                <!-- /.info-box -->
            </a>
        </div>
        <!-- /.col -->
        <div class="col-md-3 col-sm-4 col-xs-10">
            <a href="@Url.Action("Shortages", "StockDetails")">
                <div class="info-box">
                    <span class="info-box-icon bg-red"><i class="fa fa-star-half-full"></i></span>
                    <div class="info-box-content">
                        <h4>Shortages</h4>
                        @*<span class="info-box-number">41,410</span>*@
                    </div>
                    <!-- /.info-box-content -->
                </div>
                <!-- /.info-box -->
            </a>
        </div>
        <!-- /.col -->
        <!-- fix for small devices only -->
        @*<div class="clearfix visible-sm-block"></div>*@
        <div class="col-md-3 col-sm-4 col-xs-10">
           <a href="@Url.Action("NewStock", "Movements")">
               <div class="info-box">
                   <span class="info-box-icon bg-green"><i class="fa fa-star"></i></span>
                   <div class="info-box-content">
                       <h4>New Stock</h4>
                       @*<span class="info-box-number">760</span>*@
                   </div>
                   <!-- /.info-box-content -->
               </div>
               <!-- /.info-box -->
           </a>
        </div>
        <!-- /.col -->
        <div class="col-md-3 col-sm-4 col-xs-10">
            <a href="@Url.Action("RecentApprovals", "RequestDetails")">
                <div class="info-box">
                    <span class="info-box-icon bg-yellow"><i class="fa fa-plus-square-o"></i></span>
                    <div class="info-box-content">
                        <h4>Recent Approvals</h4>
                        @*<span class="info-box-number">2,000</span>*@
                    </div>
                    <!-- /.info-box-content -->
                </div>
                <!-- /.info-box -->
            </a>
        </div>
        <!-- /.col -->
    </div>
    <!-- /.row -->
    <div class="row">
        <div class="col-md-12">
            <div class="box">
                <div class="box-header with-border">
                    <h3 class="box-title">Current Stock Levels</h3>
                </div>
                <!-- /.box-header -->
                <div class="box-body">
                    <div class="row">
                        <div class="col-md-7">
                            <div class="chart">
                                <!-- Sales Chart Canvas -->
                                <canvas id="myChart" width="400" height="250px" ></canvas>
                            </div>
                            <!-- /.chart-responsive -->
                        </div>
                        <!-- /.col -->
                        <div class="col-md-5">
                            <div class="info-box bg-aqua">
                                <span class="info-box-icon"><i class="ion ion-ios-pricetag-outline"></i></span>
                                <div class="info-box-content">
                                    <span class="info-box-text">Pending Approval</span>
                                    @*<span class="info-box-number">5,200</span>*@
                                    <div class="progress">
                                        <div class="progress-bar" style="width: 50%"></div>
                                    </div>
                                    @*<span class="progress-description">50% Increase in 30 Days</span>*@
                                </div>
                            </div>
                            <div class="info-box bg-red">
                                <span class="info-box-icon"><i class="ion ion-ios-heart-outline"></i></span>
                                <div class="info-box-content">
                                    <span class="info-box-text">Items Returned</span>
                                    @*<span class="info-box-number">92,050</span>*@
                                    <div class="progress">
                                        <div class="progress-bar" style="width: 20%"></div>
                                    </div>
                                    @*<span class="progress-description">
                    20% Increase in 30 Days
                </span>*@
                                </div>
                                <!-- /.info-box-content -->
                            </div>
                            <div class="info-box bg-green-gradient">
                                <span class="info-box-icon"><i class="ion ion-ios-cloud-download-outline"></i></span>
                                <div class="info-box-content">
                                    <span class="info-box-text">Reversals</span>
                                    @*<span class="info-box-number">114,381</span>*@
                                    <div class="progress">
                                        <div class="progress-bar" style="width: 70%"></div>
                                    </div>
                                    @*<span class="progress-description">70% Increase in 30 Days</span>*@
                                </div>
                            </div>
                            <div class="info-box bg-yellow-gradient">
                                <span class="info-box-icon"><i class="ion-ios-chatbubble-outline"></i></span>
                                <div class="info-box-content">
                                    <span class="info-box-text">Monthly Withdrawals</span>
                                    @*<span class="info-box-number">163,921</span>*@
                                    <div class="progress">
                                        <div class="progress-bar" style="width: 40%"></div>
                                    </div>
                                    @*<span class="progress-description">40% Increase in 30 Days</span>*@
                                </div>
                            </div>

                        </div>
                        <!-- /.col -->
                    </div>
                    <!-- /.row -->
                </div>
                <!-- ./box-body -->
                <div class="box-footer">
                   
                </div>
                <!-- /.box-footer -->
            </div>
            <!-- /.box -->
        </div>
        <!-- /.col -->
    </div>
    <!-- /.row -->

</section>

<script type="text/javascript">
    $(document).ready(function () {
        $.get("/Home/DataFromDataBase/", function (data) {
            BuildChart(data);
        });
    });
</script>



<script>
    function BuildChart(result) {
        var dataPoints = [];
        var labels = [];
        $.each(result, function (index, value) {
            dataPoints.push(value.quantity);
            labels.push(value.description);
        });
        var ctx = document.getElementById("myChart");
        var myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Quantity Available',
                    data: dataPoints,
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(255, 206, 86, 0.2)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 159, 64, 0.2)'
                    ],
                    borderColor: [
                        'rgba(255,99,132,1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                },
                title: {
                    display: false,
                    text: 'Current Levels'
                }
            }
        });
    }

</script>